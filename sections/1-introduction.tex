% \textsc{Matlab}
\chapter{Introduction}
\label{chap1}
\textit{In this chapter, the background of soft quadruped robots and reinforce learning approaches to its control is presented. Formulated research questions are listed together with methodologies. In addition, the limitations and delimitation to this thesis are discussed, as well as the ethics and sustainability analysis.}

\section{Background}
Robots are becoming increasingly ubiquitous in our lives, with applications ranging from manufacturing to healthcare\cite{wangCurrentResearchesFuture2018}. While conventional quadruped robots are characterized by their rigid structure, their potential to function in unstructured and hazardous environments, such as those encountered during search and rescue missions\cite{hawkesSoftRobotThat2017}, industrial production lines\cite{gehringANYmalFieldSolving2021}, and scientific research endeavors\cite{hewingLearningbasedModelPredictive2020}, has been widely recognized\cite{mengReviewQuadrupedRobots2016}. Conversely, the deformable nature of soft robots has garnered considerable attention owing to their distinctive capability of deforming and adjusting to their surroundings, making them particularly suitable for tasks necessitating interaction with humans or fragile objects\cite{muralidharanSoftQuadrupedRobot2021}. Nonetheless, The control of soft quadruped robot motion poses a significant challenge due to the deformable nature of such robots, which requires the development of sophisticated control strategies capable of adapting to the robot's dynamic and ever-changing morphology\cite{wangControlStrategiesSoft2022}. The need to address this challenge underscores the importance of devising novel control techniques that can effectively modulate the motion of soft quadruped robots. As such, this thesis project aims to explore innovative control strategies that can enable effective control of soft quadruped robot motion, thereby contributing to the development of advanced soft robotics technology.

In the previous studies\cite{thorapallimuralidharanContinuumActuatorBased2020} completed by the KTH Mechatronics and Embedded Control Systems Unit, tendon-driven soft continuum actuators were implemented in \ac{3D} /\ac{4D} printed structures to operate as legs of quadruped robots. Specifically, the tendons are used to transmit the force from motors, while the soft material acts as the core and the rigid disc acts as the tendon guide to form the actuator body. Since soft legs are inherently compliant to the terrain, they have had an increased capability of traversing complicated environments. Based on this soft leg, a soft quadrupedal robot prototype was developed and gait analysis was performed to enable the robot to walk\cite{daneliaStructureGaitOptimizationof2021}. Modelling for the actuators and legs are quite important for closed loop control, since the robots will benefit from feedback to the closed loop control when interacting with the terrine. Therefore, the KTH team\cite{muralidharanSoftQuadrupedRobot2021} have already investigated the modeling process of a quadruped robot enabled by four tendon-driven continuum actuators on MathWorks Simulink\textsuperscript{\textregistered}. Based on the developed soft robot model, an optimal gait controller was developed by a \ac{MFRL}\cite{jiSynthesizingOptimalGait2022} recently.

\ac{RL} has shown great potential in studying the control of quadruped robot motion due to its ability to learn complex control policies through trial-and-error interactions with the environment\cite{rechtTourReinforcementLearning2019}. This approach is particularly relevant for soft quadruped robots, as their continuous and deformable morphology poses significant challenges for traditional control methods\cite{zhangEffectiveSoftRobot2017}. Moreover, \ac{RL} enables the robot to learn from experience, allowing it to optimize its behavior based on feedback received from the environment in the form of a reward signal, thereby leading to the development of more efficient and robust control policies that can handle complex and unpredictable environments\cite{jiLearningbasedControl4D}. Consequently, \ac{RL} is well-suited for studying the control of complex systems such as soft quadruped robots that are difficult to model and control using traditional methods\cite{rechtTourReinforcementLearning2019}. Although various \ac{RL} algorithms have been used to develop policies for quadruped robots with varying degrees of success\cite{cebeOnlineDynamicTrajectory2021,chignoliOnlineTrajectoryOptimization2021,chignoliRapidReliableQuadruped2022}, challenges remain in developing \ac{RL}-based gait control strategies that can handle the continuous and deformable morphology of the robot while also being computationally efficient\cite{wangEfficientLearningRobust2022}. Thus, gait control of soft quadruped robots is a promising area of research with the potential to advance the field of soft robotics. Further research is considered to develop more efficient and effective \ac{RL} control strategies that can handle the complexity of these robots and enable them to perform tasks in real-world environments\cite{annaswamyAdaptiveControlIntersections2023}. Looking ahead, it is likely that \ac{RL} will continue to be applied for learning dynamic walking gaits for quadruped robots in both simulated and real-world environments. Furthermore, it is expected that \ac{RL} will be utilized for controlling the behavior of quadruped robots in various tasks, including but not limited to obstacle avoidance and terrain adaptation. These applications of \ac{RL} hold great potential for advancing the field of robotics gait control and improving the efficiency and effectiveness of soft quadruped robots in various practical applications.

\section{Problem Statement}
 The gait controller was first trained and evaluated in the simulation platform, and then it was deployed in the physical robot prototype for experimental testing. The developed gait control can be optimum, but the achieved walking speed on the real robot was half of the target speed in the simulation\cite{jiSynthesizingOptimalGait2022}. The current approach also applied Simscape\textsuperscript{\textregistered} Multibody functions to describe the robot dynamics, which achieved a relatively accurate physical representation but at a very low time efficiency of the simulator. Thus, the learning efficiency of the \ac{RL} algorithm is limited, and it is desired to be improved. The concept of \ac{MBRL} is considered to generate a functional representation of the robotâ€™s interaction with the external environment, so as to resemble the physical plant model and provide the state update feedback with high accuracy efficiently\cite{rayModelBasedReinforcementLearning2010}. In \ac{MBRL}, the agent learns a surrogate model of the environment, which can be used to make predictions about the future state of the environment and the possible outcomes of different actions, which allows the agent to plan ahead and make more informed decisions, allowing it to learn more efficiently and solve tasks more effectively\cite{polydorosSurveyModelBasedReinforcement2017}. Compared to the Simscape\textsuperscript{\textregistered} Multibody functions, this predictive model is expected to improve the simulation efficiency while guaranteeing the model fidelity, which can benefit the following \ac{RL} gait training. 
 
 Furthermore, the soft robot model was used as the environment model for the \ac{RL} agent\cite{jiSynthesizingOptimalGait2022}, which monitors the locomotion of soft quadruped robots. Model-based \ac{RL} is prior to \ac{MFRL} in certain scenarios, some literature\cite{polydorosSurveyModelBasedReinforcement2017,wangBenchmarkingModelBasedReinforcement2019} stated that at robotic applications, the \ac{MBRL} utilizes a model of the environment to make predictions about the outcomes of different actions, which can lead to more efficient learning. The model-free \ac{RL} learns directly from experience without building a model of the environment\cite{arulkumaranDeepReinforcementLearning2017}, and it often require large amounts of data to learn a policy that can achieve optimal performance\cite{calisirModelFreeReinforcementLearning2019}. With a surrogate model, a model-based \ac{RL} agent can simulate different possible future trajectories, allowing it to select actions that maximize rewards\cite{fazeliSeeFeelAct2019}. Model-based \ac{RL} approach can also help reduce the sample complexity and improve the data efficiency of the learning process\cite{atkesonComparisonDirectModelbased1997}. The policy learnt by the surrogate model is different from that by model-free \ac{RL}\cite{fazeliSeeFeelAct2019}, which might make a significant difference to the policy learnt and affect the walking performance of soft quadruped robots, so the evaluation of the controllers will not focus on the algorithms, but on the benefits to the ability of a robot to walk in terms of stability, walking speed and cost-of-transport. 

 However, the input value to the \ac{RL} agent consists of state space and action space, and the state space was defined by available sensor measurements, including robot moving velocity in three directions, rotational angle in three directions and normalized contact force on four feet\cite{jiSynthesizingOptimalGait2022}. The action space was defined by motors on the legs, and three motors on each leg\cite{jiSynthesizingOptimalGait2022}. Therefore, the state-action space of the reaches 22 dimensions, which expands the computational requirements and leads to sparsity in the reward function. As discussed in the background, the state space of the surrogate model consists of state transitions states and reward function states, which will also reach a significant high dimensions. In order to increase the learning efficiency, there could be several ways to restrict the state space of the plant model, one of them could be restricting the state-action space in the model, for example, the feature extraction, which means some relevant features could be extracted and composed based on the kinematics of certain gaits. In the previous training\cite{jiSynthesizingOptimalGait2022}, the gait controllers were learnt from scratch, but rigid quadruped robots can have certain patterns of leg movements, including trot, pace, bound, pronk, gallop, etc.\cite{zhongAnalysisResearchQuadruped2019}, so that if the gait controllers could be defined on certain patterns, the gait controllers could be simplified by some certain gaits and some actions could be composed to reduce the state-action space so as to increase the learning efficiency\cite{owakiQuadrupedRobotExhibiting2017}. The trot is a common gait in all domestic quadrupeds\cite{jiOmnidirectionalWalkingQuadruped2022}. It is well-suited for rough, irregular ground and for traveling long distances at a fair rate of speed, because work is spread evenly over all four limbs, and diagonal support makes it easy to maintain equilibrium\cite{fletcherTrot2012}, so it is considered to restrict the pattern of a soft quadruped robot to trot. Another method to restrict the state space of the plant model is parameterization, the phases between gait generator and control policy could be studied and defined based on the abstraction of the quadruped robot to parameterize various gaits for robust control of rigid quadruped robots\cite{shaoLearningFreeGait2022}. Based on previous parameterization on the continuum actuators\cite{jiOmnidirectionalWalkingQuadruped2022}, such techniques could be considered to be applied on the surrogate model so as to increase the learning efficiency by reducing the search space of the state space.
 
 \subsection*{Research Questions}
To elaborate, the problem addressed in this thesis was initially formulated by a set of research questions, which aimed to identify and explore the challenges and opportunities associated with gait control of soft quadruped robots. The following questions were designed to guide the research process and help frame the problem in a meaningful and relevant way.
\begin{enumerate}
    \item \label{rq1}How to restrict the state space or design a surrogate model with high estimation accuracy of soft quadruped robots plant compared to using Simulink Multibody functions? This model could be extracted as a representation of the real system, allowing for efficient and accurate simulations and training. Some methods considered to restrict the state space:
    \begin{enumerate}
        \item Feature extraction, it involves selecting a subset of features based on the certain pattern of quadruped robots, i.e. trot.
        \item Parameterization, the higher-level abstractions of the state-action space, it will use phases between gait and real motors to parameterize gaits of quadruped robots.
    \end{enumerate}
    \item \label{rq2}In comparison to model-free \ac{RL}, to what extend can the model-based \ac{RL} approach generate a better \ac{RL} agent and enhance the ability of a soft quadruped robot to walk in terms of stability, walking speed, and cost-of-transport? The enhancement than model-free \ac{RL} is a benchmark of this project. Furthermore, it is important to evaluate the performance of model-based \ac{RL}, and the evaluation of performance of this project focus on the simulation benefices, so what the trade-off is among the learning efficiency, the simulation accuracy and the long-term planning accuracy in order to train an optimal policy for gait control of soft quadruped robot?
\end{enumerate}
The ultimate goal of this thesis was to advance our understanding of gait control for soft quadruped robots and contribute to the development of effective strategies for controlling their motion. This was achieved by addressing a set of research questions, the answers to which are presented in Chapter \ref{chap6}. 

\section{Objectives} 
The objective of this study is to investigate and address the learning efficiency issues associated with the current methods utilized for optimal gait control of soft quadruped robots. This thesis proposes a model-based reinforcement learning approach to improve the learning efficiency and accuracy of optimal gait control while developing resilient and efficient gait control policies that can handle the continuous and deformable morphology of the robot. Moreover, the research strives to explore the potential benefits of soft quadruped robots over other robot types in their capability to adapt to complex environment without human intervention. Ultimately, this thsis seeks endeavors to make a valuable contribution to the development of more efficient and effective RL control strategies that can facilitate soft quadruped robots to perform tasks in real-world scenarios.

\section{Method}
In this degree project, a set of methodologies and methods have been employed to address the research questions and achieve the objectives. The methodology employed comprises four main stages, namely data collection and processing, model-based \ac{RL} algorithm development and comparison, evaluation and analysis, and validation. Detailed description of these methodologies and methods will be presented in Chapter \ref{chap3}. Firstly, the signals to motors from the typical trot of quadruped robots were extracted by studying the actuation of the soft quadruped robot trot pattern. Subsequently, a model of the soft quadruped robot was obtained and used to generate simulation data using the Simscape model based on the extracted state space. A surrogate model was then designed with high estimation accuracy of the soft quadruped robot plant based on the processed data, which could effectively simulate the dynamics of the system and train an optimal policy for gait control. Secondly, a model-based reinforcement learning algorithm was developed for gait control of the soft quadruped robot using the extracted features and the reduced state space. The algorithm's performance was evaluated in simulation using metrics such as stability, walking speed, and cost-of-transport, and its design and parameters were iteratively modified to improve its performance. The previous model-free reinforcement learning algorithm's performance was also evaluated and compared using the same metrics. Thirdly, the trade-offs between learning efficiency, simulation accuracy, and long-term planning accuracy were evaluated in the context of training an optimal policy for gait control of the soft quadruped robot. The results were analyzed to draw conclusions about the effectiveness of the proposed model-based reinforcement learning approach compared to model-free reinforcement learning. Finally, the proposed approach was validated by implementing the optimal policy on the physical soft quadruped robot and measuring its performance in a real-world setting in terms of walking speed, stability, and cost-of-transport. The physical robot's performance was compared with the simulated results to validate the accuracy of the simulation and the effectiveness of the proposed approach. The graphical representation depicted in the Figure \ref{fig:method} provides a comprehensive outline of this thesis and enumerates the areas of investigation that have been explored.
\input{figures/method}

\section{Limitations and Delimitation}
\subsection*{Limitations}
The sim-to-real gap refers to the differences between simulations and real-world scenarios, which can lead to discrepancies in performance when transferring a simulated model to the physical world. This is a limitation of the research because the results obtained from simulations may not accurately reflect the behavior of the real-world system, and the conclusions drawn from such simulations may not be applicable in practice. The linked legs of the robot restrict the range of possible gaits that can be studied because they limit the robot's ability to move in certain ways. For example, if the legs are mechanically linked, the robot may not be able to perform certain types of locomotion that require individual leg movement. This is a limitation of the research because it restricts the exploration of certain locomotion strategies that may be relevant to real-world scenarios.

\subsection*{Delimitation}
 This thesis will focus on exploring and addressing the issues of model-based reinforcement learning for optimal gait control of soft quadruped robots. For this particular study, there are several delimitations important to consider. Firstly, it focuses specifically on soft quadruped robots and does not take into account other types of robots or robotic systems. Secondly, simulations and experiments are limited to a controlled environment and may not accurately reflect real-world scenarios. Thirdly, the effects of external factors such as wind, terrain, or obstacles are not considered in this study. Additionally, the project assumes that the soft quadruped robot is functioning correctly and does not address potential hardware malfunctions or failures. Finally, this project is limited to a specific model-based algorithm and does not consider other potential approaches or methods.
 
\section{Ethics and Sustainability}
The use of robotics and artificial intelligence raises ethical and sustainability considerations that need to be addressed in this project. One ethical consideration is related to the potential for the quadruped robot to be used for military or surveillance purposes, which could have negative impacts on privacy and human rights. To ensure that the robot is used ethically, the project will focus on the development of an optimal gait controller for soft quadruped robots for use in research and other non-military applications. Sustainability considerations include the environmental impact of the materials used in the construction of the robot, as well as the potential impact of the project on the environment through energy consumption and waste. To address these considerations, the project will use environmentally-friendly materials where possible and focus on energy efficiency in the design and testing of the robot.

\section{Outline}
This paper is structured into 6 chapters, beginning with an introductory Chapter \ref{chap1} that provides readers with necessary contextual information and a clear overview of this thesis. Chapter \ref{chap2} is dedicated to a comprehensive review of existing literature in the field, with a particular focus on defining key concepts and providing a thorough problem description. This chapter deals with the design of soft continuum actuator and the design of the test rig used to test the dynamics of the actuators. Chapter \ref{chap3} introduces the methods used to answer the research questions. It also details the design of the soft quadrupedal robot, including its mechanical and electrical design and the method to generate gaits. Chapter \ref{chap4} talks about the implementation of detailed design and the experiments conducted for the research questions. Chapter \ref{chap5} presents the results of the experiments. This chapter also includes the structure adjustment of the soft actuators for experiments. Chapter \ref{chap6} presents the conclusion of the thesis project and the future work. 

In Chapter 2, the existing literature in the field is reviewed, and key concepts are discussed in detail, along with a more comprehensive problem description. Chapter 3 outlines the research methods utilized to address the research questions and elucidates the mechanical and electrical design of the soft quadrupedal robot, as well as the method used to generate gaits. Chapter 4 is devoted to the implementation of the detailed design and the experiments carried out to investigate the research questions. In Chapter 5, the findings of the experiments are presented, which also includes the structural modifications made to the soft actuators for the experiments. Finally, Chapter 6 provides a comprehensive summary of the research project and its future prospects.

The present paper is structured into six chapters, beginning with an introductory Chapter 1 that provides readers with necessary contextual information and a clear overview of the methodology utilized to examine the research questions at hand. Chapter 2 is dedicated to a comprehensive review of existing literature in the field, with a particular focus on defining key concepts and providing a thorough problem description. In Chapter 3, the research methods employed in addressing the research questions are elaborated upon, including a detailed exposition of the mechanical and electrical design of the soft quadrupedal robot and the procedure utilized to generate gaits. The implementation of the detailed design and experiments carried out to investigate the research questions are detailed in Chapter 4. The results of these experiments are presented in Chapter 5, which includes a discussion of the structural modifications made to the soft actuators for the purpose of experimentation. Finally, Chapter 6 offers a comprehensive conclusion to the research project and outlines potential future directions for research in this area.